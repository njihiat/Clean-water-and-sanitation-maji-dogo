Solving the water crisis in a fictional country Maji Dogo.

President Naledi has tasked me with finding nuggets of insight that will help the government solve the water crisis in Maji Dogo. After
completing a survey in the country, a database of 60,000 records was created.

The database contains these tables:
  data_dictionary,   employee,   global_water_access,   location,   visits,  water_quality,  water_source,  well_pollution

Some tables contained errors as evident after running some SQL queries as outlined in the SQL code document. The errors were removed as part
of the data cleaning process.
The table affected included the water_pollution table.

The delve into the location table clearly shows that there are enough records and that the entire country was covered during the survey exercise.
Our dataset represents the actual situation on the ground. 60% of the water sources are in the rural areas.

According to the global_water_access table, the national population of Maji Ndogo is 27,628,100 people. But the accurate number from the water_source
the table is 27,628,140 this shows that our records have the same information across different tables.
The average population per water source is; tap_in_home	644 	tap_in_home_broken	649		well	279		shared_tap	2071	river	699. This explains
a lot, first the tap in home records are combined taps of several homes, taking an average of 6 people per household then 644/6 ~app 100 taps 
per one record. 
The shared taps are the most concerning, with 2000 people per tap, no wonder there are long waiting times in the queues, adding more public taps
should be the priority of the government.
There are on average 279 people served per well. There are 17383 wells but out of those 12467 are contaminated, that's a huge number, right?

Let's start with the solution.
We need to make data-driven decisions on how to fix the water sources that need improvement. After ranking the sources according to the number
of people served, as shown in the SQL CODE LINE 148, we get this table
                            shared_tap	        11945272	  1
                            well	              4841724	    2
                            tap_in_home_broken	3799720	    3
                            river              	2362544	    4
We have excluded the tap in the home because they are in the best condition and no improvement is needed. Shared taps need to be improved first,
then wells, and then repairing broken taps in homes in that order. But what taps are we going to fix?? 
Good, by using row_number ranking and window function, I can rank the sources according to the total number of people served and give the
engineers a fine list that they can follow to make improvements and track their progress.

Shall we look at the visit table? 
The survey took 924 days, which is about 2 and a half years. 
The average queue time is 123 minutes, which is about 2 hours, but some days have longer average hours than others. Saturday, for example
has an average of 246 minutes while Sunday has 82 minutes.
The queue time also varies according to the time of the day. Morning hours have longer queues.








