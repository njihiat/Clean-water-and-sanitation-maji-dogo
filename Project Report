Solving the water crisis in a fictional country Maji Dogo.

President Naledi has tasked me with finding nuggets of insight that will help the government solve the water crisis in Maji Dogo. After
completing a survey in the country, a database of 60,000 records was created.

The database contains these tables:
  data_dictionary,   employee,   global_water_access,   location,   visits,  water_quality,  water_source,  well_pollution

Some tables contained errors as evident after running some SQL queries as outlined in the SQL code document. The errors were removed as part
of the data cleaning process.
The table affected included the water_pollution table.

The delve into the location table clearly shows that there are enough records and that the entire country was covered during the survey exercise.
Our dataset represents the actual situation on the ground. 60% of the water sources are in the rural areas.

According to the global_water_access table, the national population of Maji Ndogo is 27,628,100 people. But the accurate number from the water_source
the table is 27,628,140 this shows that our records have the same information across different tables.
The average population per water source is; tap_in_home	644 	tap_in_home_broken	649		well	279		shared_tap	2071	river	699. This explains
a lot, first the tap in home records are combined taps of several homes, taking an average of 6 people per household then 644/6 ~app 100 taps 
per one record. 
The shared taps are the most concerning, with 2000 people per tap, no wonder there are long waiting times in the queues, adding more public taps
should be the priority of the government.
There are on average 279 people served per well. There are 17383 wells but out of those 12467 are contaminated, that's a huge number, right?

Let's start with the solution.
We need to make data-driven decisions on how to fix the water sources that need improvement. After ranking the sources according to the number
of people served, as shown in the SQL CODE LINE 148, we get this table
                            shared_tap	        11945272	  1
                            well	              4841724	    2
                            tap_in_home_broken	3799720	    3
                            river              	2362544	    4
We have excluded the tap in the home because they are in the best condition and no improvement is needed. Shared taps need to be improved first,
then wells, and then repairing broken taps in homes in that order. But what taps are we going to fix?? 
Good, by using row_number ranking and window function, I can rank the sources according to the total number of people served and give the
engineers a fine list that they can follow to make improvements and track their progress.

Shall we look at the visit table? 
The survey took 924 days, which is about 2 and a half years. 
The average queue time is 123 minutes, which is about 2 hours, but some days have longer average hours than others. Saturday, for example,
has an average of 246 minutes while Sunday has 82 minutes.
The queue time also varies according to the time of the day. Morning hours have longer queues.
Hour_of_the_day	Sunday	Monday	Tuesday	Wednesday	Thursday	Friday	Saturday	Sunday
6:00	79	190	134	112	134	153	247	79
7:00	82	186	128	111	139	156	247	82
8:00	86	183	130	119	129	153	247	86
9:00	84	127	105	94	99	107	252	84
10:00	83	119	99	89	95	112	259	83
11:00	78	115	102	86	99	104	236	78
12:00	78	115	97	88	96	109	239	78
13:00	81	122	97	98	101	115	242	81
14:00	83	127	104	92	96	110	244	83
15:00	83	126	104	88	92	110	248	83
16:00	83	127	99	90	99	109	251	83
17:00	79	181	135	121	129	151	251	79
18:00	80	174	122	113	132	158	240	80
19:00	127	159	145	176	137	103	282	127

This survey aimed to identify the water sources people use, the conditions, and the time people spend in the queue.
By now there are some insights that we have uncovered in the numbers and characters.
    1. Most water sources are in the rural areas
    2. 43% of the people share taps, and 2000 people share one tap.
    3. 31% of the people have piped water but 45 of them face breakage problems and have no access to water.
    4. 18%of the people use well but only 28% of them are clean and safe to use.
    5. The citizens face long queue times averaging 120 minutes.
    6. In terms of queues:
        - Saturdays have the longest queues
        - Queues are longer in the evening and afternoon
        - Wednesday and Sunday have shorter queues.

------ START OF THE PLAN --------
1. To significantly cut down queue times for everyone, let's concentrate our efforts on enhancing the shared tap experience.
2. Resolving the contamination issue in most wells is crucial, as it brings substantial benefits to the majority of people that
    we need to address.
3. Benefiting the majority and concurrently diminishing wait times for others can be achieved by addressing and improving our 
    existing infrastructure; we need to focus on this.
4. Allocating resources more effectively calls for temporarily postponing the fixing of broken taps, a step we need to take at the moment.
5. To tap into abundant sources waiting to be optimized and enhanced, our engineers need to prepare for venturing into rural areas,
    which we need them to do.

---- PRACTICAL SOLUTION ------
1. For those communities using rivers, we can dispatch trucks to supply water as a short-term fix.
2. If the communities are using wells, we need to install UV filters and reverse osmosis filters in the wells as we look into what is 
  contaminating the water.
3. For shared taps, we can send tanks to the busiest taps and the busiest time of the day as we install extra taps to reduce the queue time
to 30 minutes.
4. Fixing the infrastructure though resource intensive, will benefit most people and therefore offers a significant impact.











